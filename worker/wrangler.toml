name = "sqlite-import-worker"
main = "src/index.js"
compatibility_date = "2026-02-10"
compatibility_flags = ["nodejs_compat"]

[vars]
CONVEX_URL = "https://different-lynx-597.convex.site"
CONVEX_IMPORT_CALLBACK_PATH = "/api/import-callback"
CORS_ALLOWED_ORIGINS = "http://localhost:8081,http://127.0.0.1:8081,https://expo-bowling-journal.expo.app"

[[r2_buckets]]
binding = "R2_IMPORTS"
bucket_name = "bowling-imports"

[[queues.producers]]
binding = "IMPORT_QUEUE"
queue = "sqlite-import-jobs"

[[queues.consumers]]
queue = "sqlite-import-jobs"
dead_letter_queue = "sqlite-import-jobs-dlq"

[[rules]]
type = "CompiledWasm"
globs = ["**/*.wasm"]
fallthrough = true
